# Angular Interview Question: Dependency Injection for Services | by Heloise Bahadiroglu | Level Up Coding

Member-only story

# Angular Interview Question: Dependency Injection for Services

[

![Heloise Bahadiroglu](https://miro.medium.com/v2/resize:fill:64:64/1*xx92Q4oJnWk5bwLyCBUp3w.jpeg)





](https://medium.com/@hbahadiroglu?source=post_page---byline--3da676906ef9---------------------------------------)

[Heloise Bahadiroglu](https://medium.com/@hbahadiroglu?source=post_page---byline--3da676906ef9---------------------------------------)

Follow

6 min read

·

Mar 11, 2020

137

Listen

Share

More

![](https://miro.medium.com/v2/resize:fit:1250/1*SSOsuc2LwCnZBK3_dU2Xpw.jpeg)
Photo by Daoud Abismail on Unsplash

Angular components are meant to be the user interface and nothing more. They display data and enable user interaction, react on user clicks and inputs. The application logic should be done in services. When you need a service in a component, you usually don’t create an instance yourself using `new`. You mark the service as `injectable` and you add it as a parameter to the component’s constructor. The Angular Dependency Injection (DI) will take care of creating an instance and will inject it for you.

It is common not to think too much about this process. When you create a service to fetch data from the server, you need only one instance of it, and it doesn’t really matter to you where it lives. But you sometimes need services to be available only inside a module, or even a component and its children. You might need to inject different instances of the service in different components. That is why a good understanding of how the Angular DI works is an important quality for an Angular developer.

# Injectors

Injectors are responsible for creating instances of the service classes and injecting them in the components that request them. Services are singletons inside an injector scope, there can be at most only one instance of a service.

Injectors are created by Angular. A _root_ injector is created in the bootstrap process. Angular will also create injectors for components, pipes or directives, but they stay empty unless you declare a _providers_ array in their decorators. Each lazy-loaded module also gets its own injector.

Injectors are inherited. When you request a service in a component, Angular will look in the injector of the component, then in the one of its parent, then of its parent’s parent’s… etc, until it either finds it or runs out of ancestors. If it hasn’t found it in the element injectors, Angular starts looking in the modules injectors, until it finds a provider (or runs out of injectors).

# Providers

Injectors create instances and inject them but you need to tell them **how** to create these instances. When you inject a service in a component, you give a _DI Token_ to the closest injector. By default the token is the service class, TestService in the example below. The injector has a map _token-provider_, the token is the key. The provider of a service is usually the class itself:

<iframe src="https://levelup.gitconnected.com/media/12241bd0f1cb1e3ae1249ad083e31f55" allowfullscreen="" frameborder="0" height="746" width="680" title="test.component.html" class="eo n hk dz bg" scrolling="no"></iframe>

In this example the service is provided only in the TestComponent and we tell Angular to use the class TestService to create an instance when injecting TestService. This is such a common behaviour that Angular gives you a shortcut for it:

providers: \[TestService\]

That also means that we can tell the injector to use some other class when injecting TestService. In the following example, we tell the injector to return an instance of the HelloWorldService when being requested the TestService.

<iframe src="https://levelup.gitconnected.com/media/b0d881f3af48aeb27a401017381558ec" allowfullscreen="" frameborder="0" height="710" width="680" title="hello-word.service.ts" class="eo n hk dz bg" scrolling="no"></iframe>

The result will then be:

![](https://miro.medium.com/v2/resize:fit:485/1*H61iml5ZGmOmjPjUF0KkIg.png)

# Injectors Hierarchy

## Root Injector

You might not be providing services in your components that regularly. By default when you create a service with the Angular cli, the service is provided in the _root_ injector.

<iframe src="https://levelup.gitconnected.com/media/c380f775f2659863eaf36e8179d1bc35" allowfullscreen="" frameborder="0" height="688" width="680" title="test.component.ts" class="eo n hk dz bg" scrolling="no"></iframe>

In this case, we don’t need to provide the service in the component’s injector. An instance of the service will be created in the _root_ injector and injected in our component. This instance will be available everywhere in the application.

![](https://miro.medium.com/v2/resize:fit:375/1*3rdXC4T-Vbl13QgsRuq87g.png)

We don’t need to provide the service anywhere else, but we can.

## Element Injectors

Even though the service can be injected by the _root_ injector, it doesn’t have to. We can decide to create an instance of our service for this component (and its children). To do so, we need to define a provider like we did earlier.

<iframe src="https://levelup.gitconnected.com/media/15e8a7e7a27052b4970be1886d8caede" allowfullscreen="" frameborder="0" height="1032" width="680" title="app.component.html" class="eo n hk dz bg" scrolling="no"></iframe>

We provided the service TestService in the TestComponent. An injector was created for the component, and will create an instance of TestService when the service gets injected.

In the AppComponent, we inject the service too. We didn’t declare any provider in this component so the instance will be created and injected by the _root_ injector. We therefore have two instances of our service in the application. In the example we created a static variable to store the number of instances:

![](https://miro.medium.com/v2/resize:fit:610/1*GyZxuIIhIW7ZpXqaw7HlZw.png)

One consequence of the hierarchy of injectors is that if you provide a service in a parent component, the same instance will be used in every child component.

<iframe src="https://levelup.gitconnected.com/media/6db61fe8edab31eb36c2841c470961fd" allowfullscreen="" frameborder="0" height="1200" width="680" title="hello-word.service.ts" class="eo n hk dz bg" scrolling="no"></iframe>

In this example, we will once again see:

![](https://miro.medium.com/v2/resize:fit:485/1*H61iml5ZGmOmjPjUF0KkIg.png)

Another important thing to note is that the instances of services don’t live longer than the injectors that created them. That means that if you provide a service in a component, the instance of the service the component is using will die with the component. You might want to think about this when the data needs to be persisted.

## Module Injector

Applications are usually organized in different modules. As by default services are provided in the _root_ injector, they are accessible from anywhere in the application, even in other modules. For example, if you have Module1 in which you defined a service TestService provided in _root_, you can use this service in a module Module2. As the service is injected by the _root_ injector, there will be only one instance of it.

If you provide the service in the module Module1 instead of in _root_, the service will still be available in Module2. That might be surprising but if Module1 is eager-loaded, it is imported in the AppModule. Module injectors flatten the providers of all the imports, so TestService will be provided in the AppModule.

If Module1 is lazy-loaded on the other hand, it is not imported in the AppModule. Providing the service in the module would make it only available inside it.

If you only provide the service in a component in Module1, the service will only be provided in the component’s injector, neither in Module1 nor in _root_. In the two last cases, trying to inject the service in a component in Module2 will result in a _No provider_ error:

![](https://miro.medium.com/v2/resize:fit:875/1*N5T-t0F3ZAD-gK23x8mxUQ.png)

You have to explicitly provide the service whether in the Module2 or in the component where you are trying to inject it or directly in the _root_ injector.

The Angular DI generally allows you to keep a low amount of service instances without having to pay too much attention to it. In most of the cases, you don’t have to worry about it. But it can become necessary to have a deeper understanding of this mechanism when you work with many modules, lazy-loaded ones, or when you need different instances of your service in your components.

Angular provides some more tool for an even greater flexibility. You might want to check the modifiers (@Optional, @SkipSelf, @Self. …) for more information.

We only covered the service case in this article. The DI can do more than this. You can for example provide values instead of classes. You can also create your own DI Token and inject elements manually using the @Inject annotation. For more details about these or about the Dependency Injection in general, I recommend you to read the Angular documentation.

## Embedded Content

{{text}}

[view raw](https://gist.github.com/Dornhoth/b4f82ffdf9f1e56fcc61efe6b2a5ee11/raw/2301a8c6a41e667957bf939a08186dee02c3bf3e/test.component.html) [test.component.html](https://gist.github.com/Dornhoth/b4f82ffdf9f1e56fcc61efe6b2a5ee11#file-test-component-html) hosted with ❤ by [GitHub](https://github.com)

import { Component, OnInit } from '@angular/core';

import { TestService } from 'src/app/services/test.service';

@Component({

selector: 'app-test',

templateUrl: './test.component.html',

styleUrls: \['./test.component.scss'\],

providers: \[{ provide: TestService, useClass: TestService }\]

})

export class TestComponent implements OnInit {

text: string;

constructor(

private testService: TestService,

) { }

ngOnInit() {

this.text \= this.testService.getTest();

}

}

[view raw](https://gist.github.com/Dornhoth/b4f82ffdf9f1e56fcc61efe6b2a5ee11/raw/2301a8c6a41e667957bf939a08186dee02c3bf3e/test.component.ts) [test.component.ts](https://gist.github.com/Dornhoth/b4f82ffdf9f1e56fcc61efe6b2a5ee11#file-test-component-ts) hosted with ❤ by [GitHub](https://github.com)

import { Injectable } from '@angular/core';

@Injectable()

export class TestService {

getTest(): string {

return 'test';

}

}

[view raw](https://gist.github.com/Dornhoth/b4f82ffdf9f1e56fcc61efe6b2a5ee11/raw/2301a8c6a41e667957bf939a08186dee02c3bf3e/test.service.ts) [test.service.ts](https://gist.github.com/Dornhoth/b4f82ffdf9f1e56fcc61efe6b2a5ee11#file-test-service-ts) hosted with ❤ by [GitHub](https://github.com)

---

import { Injectable } from '@angular/core';

@Injectable()

export class HelloWorldService {

getTest(): string {

return 'Hello World!';

}

}

[view raw](https://gist.github.com/Dornhoth/08b87bbfce4eadf2ca5356a9feb8dc86/raw/3e32a149b0546bacc6eda0ccde3e96dee972a7a5/hello-word.service.ts) [hello-word.service.ts](https://gist.github.com/Dornhoth/08b87bbfce4eadf2ca5356a9feb8dc86#file-hello-word-service-ts) hosted with ❤ by [GitHub](https://github.com)

import { Component, OnInit } from '@angular/core';

import { TestService } from 'src/app/services/test.service';

import { HelloWorldService } from 'src/app/services/hello-world.service';

@Component({

selector: 'app-test',

templateUrl: './test.component.html',

styleUrls: \['./test.component.scss'\],

providers: \[{ provide: TestService, useClass: HelloWorldService }\]

})

export class TestComponent implements OnInit {

text: string;

constructor(

private testService: TestService,

) { }

ngOnInit() {

this.text \= this.testService.getTest();

}

}

[view raw](https://gist.github.com/Dornhoth/08b87bbfce4eadf2ca5356a9feb8dc86/raw/3e32a149b0546bacc6eda0ccde3e96dee972a7a5/test.component.ts) [test.component.ts](https://gist.github.com/Dornhoth/08b87bbfce4eadf2ca5356a9feb8dc86#file-test-component-ts) hosted with ❤ by [GitHub](https://github.com)

---

import { Component, OnInit } from '@angular/core';

import { TestService } from 'src/app/services/test.service';

import { HelloWorldService } from 'src/app/services/hello-world.service';

@Component({

selector: 'app-test',

templateUrl: './test.component.html',

styleUrls: \['./test.component.scss'\],

})

export class TestComponent implements OnInit {

text: string;

constructor(

private testService: TestService,

) { }

ngOnInit() {

this.text \= this.testService.getTest();

}

}

[view raw](https://gist.github.com/Dornhoth/eae343f05519262dcd39e438e63a1f46/raw/f14472f932c146061d98dea428ab4128591e5389/test.component.ts) [test.component.ts](https://gist.github.com/Dornhoth/eae343f05519262dcd39e438e63a1f46#file-test-component-ts) hosted with ❤ by [GitHub](https://github.com)

import { Injectable } from '@angular/core';

@Injectable({ providedIn: 'root' })

export class TestService {

getTest(): string {

return 'test';

}

}

[view raw](https://gist.github.com/Dornhoth/eae343f05519262dcd39e438e63a1f46/raw/f14472f932c146061d98dea428ab4128591e5389/test.service.ts) [test.service.ts](https://gist.github.com/Dornhoth/eae343f05519262dcd39e438e63a1f46#file-test-service-ts) hosted with ❤ by [GitHub](https://github.com)

---

<app-test\></app-test\>

<div\>Number of service instances : {{serviceInstances}}</div\>

[view raw](https://gist.github.com/Dornhoth/20af7b789ec12f7e4ae5844014954ea2/raw/c862d6e4a795aa73b451dcbc42446ef89c3f221d/app.component.html) [app.component.html](https://gist.github.com/Dornhoth/20af7b789ec12f7e4ae5844014954ea2#file-app-component-html) hosted with ❤ by [GitHub](https://github.com)

import { Component, OnInit } from '@angular/core';

import { TestService } from './services/test.service';

@Component({

selector: 'app-root',

templateUrl: './app.component.html',

styleUrls: \['./app.component.scss'\],

})

export class AppComponent implements OnInit {

title \= 'providers';

serviceInstances: number;

constructor(

private testService: TestService,

) { }

ngOnInit() {

this.serviceInstances \= this.testService.numberOfInstances;

}

}

[view raw](https://gist.github.com/Dornhoth/20af7b789ec12f7e4ae5844014954ea2/raw/c862d6e4a795aa73b451dcbc42446ef89c3f221d/app.component.ts) [app.component.ts](https://gist.github.com/Dornhoth/20af7b789ec12f7e4ae5844014954ea2#file-app-component-ts) hosted with ❤ by [GitHub](https://github.com)

import { Component, OnInit } from '@angular/core';

import { TestService } from 'src/app/services/test.service';

@Component({

selector: 'app-test',

templateUrl: './test.component.html',

styleUrls: \['./test.component.scss'\],

providers: \[TestService\]

})

export class TestComponent implements OnInit {

text: string;

constructor(

private testService: TestService,

) { }

ngOnInit() {

this.text \= this.testService.getTest();

}

}

[view raw](https://gist.github.com/Dornhoth/20af7b789ec12f7e4ae5844014954ea2/raw/c862d6e4a795aa73b451dcbc42446ef89c3f221d/test.component.ts) [test.component.ts](https://gist.github.com/Dornhoth/20af7b789ec12f7e4ae5844014954ea2#file-test-component-ts) hosted with ❤ by [GitHub](https://github.com)

---

import { Injectable } from '@angular/core';

@Injectable({

providedIn: 'root'

})

export class HelloWorldService {

getTest(): string {

return 'Hello World!';

}

}

[view raw](https://gist.github.com/Dornhoth/bc6560127c9f9116fd067671fc9416bb/raw/d0e5e9f04b17f73884b1d573b949a20093485c55/hello-word.service.ts) [hello-word.service.ts](https://gist.github.com/Dornhoth/bc6560127c9f9116fd067671fc9416bb#file-hello-word-service-ts) hosted with ❤ by [GitHub](https://github.com)

import { Component } from '@angular/core';

import { TestService } from 'src/app/services/test.service';

import { HelloWorldService } from 'src/app/services/hello-world.service';

@Component({

selector: 'app-parent',

templateUrl: './parent.component.html',

styleUrls: \['./parent.component.scss'\],

providers: \[{ provide: TestService, useClass: HelloWorldService }\]

})

export class ParentComponent { }

[view raw](https://gist.github.com/Dornhoth/bc6560127c9f9116fd067671fc9416bb/raw/d0e5e9f04b17f73884b1d573b949a20093485c55/parent.component.ts) [parent.component.ts](https://gist.github.com/Dornhoth/bc6560127c9f9116fd067671fc9416bb#file-parent-component-ts) hosted with ❤ by [GitHub](https://github.com)

import { Component, OnInit } from '@angular/core';

import { TestService } from '../../services/test.service';

@Component({

selector: 'app-test',

templateUrl: './test.component.html',

styleUrls: \['./test.component.scss'\],

})

export class TestComponent implements OnInit {

text: string;

constructor(

private testService: TestService,

) { }

ngOnInit() {

this.text \= this.testService.getTest();

}

}

[view raw](https://gist.github.com/Dornhoth/bc6560127c9f9116fd067671fc9416bb/raw/d0e5e9f04b17f73884b1d573b949a20093485c55/test.component.ts) [test.component.ts](https://gist.github.com/Dornhoth/bc6560127c9f9116fd067671fc9416bb#file-test-component-ts) hosted with ❤ by [GitHub](https://github.com)

import { Injectable } from '@angular/core';

@Injectable({ providedIn: 'root' })

export class TestService {

getTest(): string {

return 'test';

}

}

[view raw](https://gist.github.com/Dornhoth/bc6560127c9f9116fd067671fc9416bb/raw/d0e5e9f04b17f73884b1d573b949a20093485c55/test.service.ts) [test.service.ts](https://gist.github.com/Dornhoth/bc6560127c9f9116fd067671fc9416bb#file-test-service-ts) hosted with ❤ by [GitHub](https://github.com)

---